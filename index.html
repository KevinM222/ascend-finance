<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ascend Crypto On-Ramp Service - Your Launchpad to the Future of Finance">
    <title>Ascend Finance</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="icon" href="assets/images/favicon_io/favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="assets/Js/dexintegration.js" defer></script>
</head>
<body>
    <!-- Hero Section -->
    <section class="hero-section">
        <div class="logo-container">
            <p class="tagline">Your Launchpad to the Future of Finance</p>
            <img src="assets/images/logo.webp" alt="Ascend Logo" class="main-logo">
        </div>

        <div class="wallet-container">
            <button id="connectWalletButton">Connect Wallet</button>
            <button id="disconnectWalletButton" style="display: none;">Disconnect Wallet</button>
            <button id="addToMetaMaskButton" style="display: none;">Add ASC to MetaMask</button>
        </div>

        <!-- Token Information -->
        <div class="token-info-top">
            <p id="tokenBalance">Your ASC Balance: N/A</p>
            <p id="tokenPrice">ASC Price: Loading...</p>
        </div>
    </section>

    <!-- Navigation Bar -->
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="roadmap.html">Roadmap</a></li>
            <li><a href="whitepaper.html">Whitepaper</a></li>
            <li><a href="https://polygonscan.com/token/0x4456b0f017f6bf9b0aa7a0ac3d3f224902a1937a" target="_blank">ASC Token</a></li>
        </ul>
    </nav>

    <!-- DEX Section -->
    <div class="dex-section">
        <h2>Decentralized Exchange</h2>
        <button onclick="swapTokens(1, 'ASC', 'POL')">Swap ASC for POL</button>
        <button onclick="addLiquidity('ASC', 'POL', 100, 200)">Add Liquidity</button>
    </div>

    <!-- Bottom Content -->
    <div class="bottom-content">
        <button class="cta-button-sushiswap" onclick="window.open('https://sushi.com/swap?inputCurrency=0x4456b0f017f6bf9b0aa7a0ac3d3f224902a1937a&outputCurrency=POL', '_blank')">
            Swap ASC on SushiSwap
        </button>
        <p class="empowering-quote">"Empower your financial future with Ascend."</p>
        <button class="cta-button" onclick="window.location.href='roadmap.html'">Explore the Roadmap</button>
    </div>

    <script>
        let currentAddress = null;

        // Automatically update wallet state on account change
        if (window.ethereum) {
            window.ethereum.on('accountsChanged', (accounts) => {
                if (accounts.length === 0) {
                    disconnectWallet();
                } else {
                    connectWallet();
                }
            });

            window.ethereum.on('chainChanged', () => {
                window.location.reload();
            });
        }

        // Connect to wallet
        async function connectWallet() {
            try {
                const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
                currentAddress = accounts[0];
                updateWalletUI(true, currentAddress);
                await updateTokenInfo();
            } catch (error) {
                console.error("Error connecting wallet:", error);
            }
        }

        // Disconnect wallet
        function disconnectWallet() {
            currentAddress = null;
            updateWalletUI(false);
        }

        // Update wallet UI
        function updateWalletUI(connected, address = null) {
            const connectButton = document.getElementById('connectWalletButton');
            const disconnectButton = document.getElementById('disconnectWalletButton');
            const addToMetaMaskButton = document.getElementById('addToMetaMaskButton');

            if (connected) {
                connectButton.textContent = `Connected: ${address.substring(0, 6)}...${address.substring(address.length - 4)}`;
                connectButton.style.backgroundColor = "#28a745"; // Green when connected
                disconnectButton.style.display = 'inline-block';
                addToMetaMaskButton.style.display = 'inline-block';
            } else {
                connectButton.textContent = 'Connect Wallet';
                connectButton.style.backgroundColor = "#007bff";
                disconnectButton.style.display = 'none';
                addToMetaMaskButton.style.display = 'none';
                document.getElementById('tokenBalance').textContent = 'Your ASC Balance: N/A';
                document.getElementById('tokenPrice').textContent = 'ASC Price: Loading...';
            }
        }

        // Update token info
        async function updateTokenInfo() {
            const balance = await getTokenBalance();
            const price = await getPrice('ASC');
            document.getElementById('tokenBalance').textContent = `Your ASC Balance: ${balance}`;
            document.getElementById('tokenPrice').textContent = `ASC Price: $${price}`;
        }
    </script>
</body>
</html>
